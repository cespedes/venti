// Copyright 2016 The Venti Authors. All rights reserved.
// Use of this source code is governed by an ISC-style
// license that can be found in the LICENSE file.

package msg

import "testing"

var (
	thelloRead = []RRow{
		{
			R: &Thello{},
			B: []byte{0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},
		},
		{
			R: &Thello{
				Tag:     1,
				Version: "venti-02-test",
				UID:     "anonymous",
			},
			B: []byte{
				0x04, 0x01, 0x00, 0x0d, 0x76, 0x65, 0x6e, 0x74, 0x69, 0x2d, 0x30,
				0x32, 0x2d, 0x74, 0x65, 0x73, 0x74, 0x00, 0x09, 0x61, 0x6e, 0x6f, 0x6e,
				0x79, 0x6d, 0x6f, 0x75, 0x73, 0x00, 0x00, 0x00,
			},
		},
		{
			R: &Thello{
				Codec:  []byte{0x00, 0x00},
				Crypto: []byte{0x00, 0x00},
			},
			B: []byte{
				0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0, 0x02, 0x000, 0x00, 0x02,
				0x00, 0x00,
			},
		},
	}

	thelloWrite = []WRow{
		{
			A: &Thello{},
			B: &Thello{},
		},
	}

	rhelloRead = []RRow{
		{
			R: &Rhello{},
			B: []byte{0x05, 0x00, 0x00, 0x00, 0x00, 0x00},
		},
		{
			R: &Rhello{
				Tag: 1,
				SID: "anonymous",
			},
			B: []byte{
				0x05, 0x01, 0x00, 0x09, 0x61, 0x6e, 0x6f, 0x6e, 0x79, 0x6d, 0x6f,
				0x75, 0x73, 0x00, 0x00,
			},
		},
		{
			R: &Rhello{
				Crypto: 0x0F,
				Codec:  0xF0,
			},
			B: []byte{0x05, 0x00, 0x00, 0x00, 0x0F, 0xF0},
		},
	}
)

func TestThelloWrite(t *testing.T) {
	readerTest(t, thelloRead)
}

func TestRhelloPack(t *testing.T) {
	readerTest(t, rhelloRead)
}

func TestThelloRead(t *testing.T) {
	writerTest(t, thelloWrite)
}
